// -- https://xemantic.github.io/shader-web-background/
const shaderWebBackground={};(()=>{'use strict';function q(a,b){if(!a)throw new shaderWebBackground.ConfigError(b);}function v(a){q(a instanceof HTMLCanvasElement,"config.canvas must be instance of canvas");return a}function w(){const a=document.createElement("canvas"),b=a.style;b.width="100vw";b.height="100vh";b.position="fixed";b.top="0";b.left="0";b.zIndex=-9999;return a}
function y(a,b,e,c,d){const n=Object.keys(b),h=new z(a,g=>new shaderWebBackground.GlError(g)),p=n.length-1,u=n.map((g,k)=>{var f=b[g];var l=h.a;var r=B(h,g,l.VERTEX_SHADER,"attribute vec2 V;void main(){gl_Position=vec4(V,0,1);}");f=B(h,g,l.FRAGMENT_SHADER,f);var m=l.createProgram();l.attachShader(m,r);l.attachShader(m,f);l.linkProgram(m);l=m;r=e[g]&&e[g].uniforms||{};k=k<p;f=h.a;m=f.getProgramParameter(l,f.ACTIVE_UNIFORMS);for(let t=0;t<m;t++){const x=f.getActiveUniform(l,t);if(!(x.name in r))throw h.c('No configuration for uniform "'+
x.name+'" defined in shader "'+g+'"');}m=null;k&&(m=new C(f,h.b),h.buffers[g]=m);return g=new D(f,g,l,r,m,h.buffers)});a.width=0;a.height=0;const A=()=>{if(a.width!==a.clientWidth||a.height!==a.clientHeight){const g=a.clientWidth,k=a.clientHeight;a.width=g;a.height=k;h.a.viewport(0,0,h.canvas.width,h.canvas.height);c&&c(g,k);u.forEach(f=>{f.a&&(f=f.a,f.b&&f.c.deleteTexture(f.b),f.a&&f.c.deleteTexture(f.a),f.b=E(f,g,k),f.a=E(f,g,k))})}u.forEach(g=>F(g,()=>{{var k=g.h;const f=h.a;f.bindBuffer(f.ARRAY_BUFFER,
h.f);f.enableVertexAttribArray(k);f.vertexAttribPointer(k,2,f.FLOAT,!1,0,0);f.drawArrays(f.TRIANGLE_STRIP,0,4);f.disableVertexAttribArray(k);f.bindBuffer(f.ARRAY_BUFFER,null)}}));u.forEach(g=>{if(g.a){{g=g.a;const k=g.a;g.a=g.b;g.b=k}}});d&&d();requestAnimationFrame(A)};A()}shaderWebBackground.ConfigError=class extends Error{constructor(a){super(a);this.name="shaderWebBackground.ConfigError"}};shaderWebBackground.GlError=class extends Error{constructor(a){super(a);this.name="shaderWebBackground.GlError"}};
shaderWebBackground.shade=function(a){a=a||{};const b=a.canvas?v(a.canvas):w();var e=document.head.querySelectorAll("script[type='x-shader/x-fragment']");q(0<e.length,'At least one <script type="x-shader/x-fragment"> required in document head');e.forEach(c=>q(c.id,"Each shader <script> needs unique id attribute"));e=Array.from(e).reduce((c,d)=>{c[d.id]=d.text.trim();return c},{});if(a.shaders)for(const c in a.shaders)q(c in e,"No shader source with id: "+c);try{y(b,e,a.shaders||{},a.onResize,a.onFrameComplete)}catch(c){if(a.fallback)console.log("Could not load shaders, adding fallback class to canvas"+
c),b.classList.add("fallback");else throw c;}a.canvas||window.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(b)})};const G=[-1,1,1,1,-1,-1,1,-1];function H(a,b){return a.f(a.a.getExtension(b),b+" extension is not supported")}class I{constructor(a,b){this.a=a;this.f=b}b(){}}class J extends I{constructor(a,b){super(a,b);this.c=H(this,"OES_texture_half_float");H(this,"OES_texture_half_float_linear")}b(a,b){const e=this.a;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,a,b,0,e.RGBA,this.c.HALF_FLOAT_OES,null)}}
class K extends I{constructor(a,b){super(a,b);H(this,"EXT_color_buffer_float")}b(a,b){const e=this.a;e.texImage2D(e.TEXTURE_2D,0,e.RGBA16F,a,b,0,e.RGBA,e.FLOAT,null)}}function B(a,b,e,c){const d=a.a;e=d.createShader(e);d.shaderSource(e,c);d.compileShader(e);if(!d.getShaderParameter(e,d.COMPILE_STATUS)){const n=String(d.getShaderInfoLog(e));d.deleteShader(e);b="Cannot compile shader - "+b+": "+n.trim();console.log(b+"\n"+c);throw a.c(b);}return e}
class z{constructor(a,b){var e={antialias:!1,depth:!1,alpha:!1};this.canvas=a;this.c=b;const c=(n,h)=>{if(!n)throw b(h);return n};let d=a.getContext("webgl2",e);if(d)this.b=new K(d,c);else if(d=a.getContext("webgl",e))this.b=new J(d,c);c(d,"webgl context not supported on supplied canvas element: "+a);this.a=d;a=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,a);d.bufferData(d.ARRAY_BUFFER,new Float32Array(G),d.STATIC_DRAW);d.bindBuffer(d.ARRAY_BUFFER,null);this.f=a;this.buffers={}}}
function F(a,b){const e=a.c;e.useProgram(a.g);for(var c in a.uniforms){var d=a.uniforms[c];d.i(e,d.location,a.f)}a.a?(c=a.a,d=c.c,d.bindFramebuffer(d.FRAMEBUFFER,c.g),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,c.a,0),b(),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0),d.bindFramebuffer(d.FRAMEBUFFER,null)):b();for(b=0;b<a.b;b++)e.activeTexture(e.TEXTURE0+b),e.bindTexture(e.TEXTURE_2D,null);a.b=0}
class D{constructor(a,b,e,c,d,n){this.c=a;this.id=b;this.g=e;this.h=a.getAttribLocation(e,"V");this.uniforms={};for(const h in c)(b=this.c.getUniformLocation(e,h))?this.uniforms[h]={location:b,i:c[h]}:console.error("No such uniform: "+h);this.a=d;this.b=0;this.f={buffers:n,texture:(h,p)=>{p=p instanceof C?p===this.a?p.b:p.a:p;a.activeTexture(a.TEXTURE0+this.b);a.bindTexture(a.TEXTURE_2D,p);a.uniform1i(h,this.b++)}}}}
function E(a,b,e){const c=a.c,d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);a.f.b(b,e);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.bindTexture(c.TEXTURE_2D,null);return d}class C{constructor(a,b){this.g=a.createFramebuffer();this.c=a;this.f=b;this.a=this.b=null}};})()
//# sourceMappingURL=shader-web-background.min.js.map
