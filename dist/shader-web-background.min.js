// -- https://xemantic.github.io/shader-web-background/
const shaderWebBackground={};(()=>{'use strict';function p(a,b){if(!a)throw new shaderWebBackground.ConfigError(b);}function q(a){p(a instanceof HTMLCanvasElement,"config.canvas must be instance of canvas");return a}function r(){const a=document.createElement("canvas"),b=a.style;b.width="100vw";b.height="100vh";b.position="fixed";b.top="0";b.left="0";b.zIndex=-9999;return a}const t=a=>'<script type="x-shader/x-fragment" id="'+a+'">';
function u(a){const b=document.getElementById(a);p(b,"Missing shader source: "+t(a));p(b instanceof HTMLScriptElement&&"x-shader/x-fragment"===b.type,'Shader source element of id "'+a+'" should be of type: '+t(a));return b.text.trim()}function v(a,b){"loading"!==document.readyState?b():window.addEventListener(a,b)}
function w(a,b,e,d){const c=new x(a,f=>new shaderWebBackground.GlError(f)),h=[],n=Object.keys(b).length-1;let l=0;for(const f in b)h.push(y(c,f,z(c,f,u(f)),b[f].uniforms||{},l++<n));a.width=0;a.height=0;const k=()=>{if(a.width!==a.clientWidth||a.height!==a.clientHeight){const f=a.clientWidth,m=a.clientHeight;a.width=f;a.height=m;c.a.viewport(0,0,c.canvas.width,c.canvas.height);e&&e(f,m);h.forEach(g=>{g.a&&(g=g.a,g.b&&g.c.deleteTexture(g.b),g.a&&g.c.deleteTexture(g.a),g.b=A(g,f,m),g.a=A(g,f,m))})}h.forEach(f=>
B(f,()=>{{var m=f.h;const g=c.a;g.bindBuffer(g.ARRAY_BUFFER,c.f);g.enableVertexAttribArray(m);g.vertexAttribPointer(m,2,g.FLOAT,!1,0,0);g.drawArrays(g.TRIANGLE_STRIP,0,4);g.disableVertexAttribArray(m);g.bindBuffer(g.ARRAY_BUFFER,null)}}));h.forEach(f=>{if(f.a){{f=f.a;const m=f.a;f.a=f.b;f.b=m}}});d&&d();requestAnimationFrame(k)};v("load",()=>requestAnimationFrame(k))}shaderWebBackground.ConfigError=class extends Error{constructor(a){super(a);this.name="shaderWebBackground.ConfigError"}};
shaderWebBackground.GlError=class extends Error{constructor(a){super(a);this.name="shaderWebBackground.GlError"}};
shaderWebBackground.shade=function(a){p(a,"Missing config argument");const b=a.canvas?q(a.canvas):r();p(a.shaders,"No shaders specified in config");try{w(b,a.shaders,a.onResize,a.onFrameComplete)}catch(e){if(a.fallback&&e instanceof shaderWebBackground.GlError)console.log("Could not load shaders, adding fallback class to canvas"+e),b.classList.add("fallback");else throw e;}a.canvas||v("DOMContentLoaded",()=>document.body.appendChild(b))};const C=[-1,1,1,1,-1,-1,1,-1];function D(a,b){return a.f(a.a.getExtension(b),b+" extension is not supported")}class E{constructor(a,b){this.a=a;this.f=b}b(){}}class F extends E{constructor(a,b){super(a,b);this.c=D(this,"OES_texture_half_float");D(this,"OES_texture_half_float_linear")}b(a,b){const e=this.a;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,a,b,0,e.RGBA,this.c.HALF_FLOAT_OES,null)}}
class G extends E{constructor(a,b){super(a,b);D(this,"EXT_color_buffer_float")}b(a,b){const e=this.a;e.texImage2D(e.TEXTURE_2D,0,e.RGBA16F,a,b,0,e.RGBA,e.FLOAT,null)}}
function y(a,b,e,d,c){const h=a.a;a.uniforms={};const n=h.getProgramParameter(e,h.ACTIVE_UNIFORMS);for(let l=0;l<n;l++){const k=h.getActiveUniform(e,l),f=d[k.name];if(!f)throw a.b('No configuration for uniform "'+k.name+'" defined in shader "'+b+'"');a.uniforms[k.name]={location:h.getUniformLocation(e,k.name),i:f}}for(const l in d)if(!(l in a.uniforms))throw a.b('No such uniform "'+l+'" defined in shader "'+b+'" - if unused it might be removed by GLSL compiler');d=null;c&&(d=new H(h,a.c),a.buffers[b]=
d);return new I(h,b,e,h.getAttribLocation(e,"V"),a.uniforms,d,a.buffers)}function z(a,b,e){const d=a.a,c=J(a,b,d.VERTEX_SHADER,"attribute vec2 V;void main(){gl_Position=vec4(V,0,1);}");a=J(a,b,d.FRAGMENT_SHADER,e);b=d.createProgram();d.attachShader(b,c);d.attachShader(b,a);d.linkProgram(b);return b}
function J(a,b,e,d){const c=a.a;e=c.createShader(e);c.shaderSource(e,d);c.compileShader(e);if(!c.getShaderParameter(e,c.COMPILE_STATUS)){const h=String(c.getShaderInfoLog(e));c.deleteShader(e);b="Cannot compile shader - "+b+": "+h.trim();console.log(b+"\n"+d);throw a.b(b);}return e}
class x{constructor(a,b){var e={antialias:!1,depth:!1,alpha:!1};this.canvas=a;this.b=b;const d=(h,n)=>{if(!h)throw b(n);return h};let c=a.getContext("webgl2",e);if(c)this.c=new G(c,d);else if(c=a.getContext("webgl",e))this.c=new F(c,d);d(c,"webgl context not supported on supplied canvas element: "+a);this.a=c;a=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,a);c.bufferData(c.ARRAY_BUFFER,new Float32Array(C),c.STATIC_DRAW);c.bindBuffer(c.ARRAY_BUFFER,null);this.f=a;this.buffers={}}}
function B(a,b){const e=a.f;e.useProgram(a.g);for(var d in a.uniforms){var c=a.uniforms[d];c.i(e,c.location,a.c)}a.a?(d=a.a,c=d.c,c.bindFramebuffer(c.FRAMEBUFFER,d.g),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,d.a,0),b(),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,null,0),c.bindFramebuffer(c.FRAMEBUFFER,null)):b();for(b=0;b<a.b;b++)e.activeTexture(e.TEXTURE0+b),e.bindTexture(e.TEXTURE_2D,null);a.b=0}
class I{constructor(a,b,e,d,c,h,n){this.f=a;this.id=b;this.g=e;this.h=d;this.uniforms=c;this.a=h;this.b=0;this.c={buffers:n,texture:(l,k)=>{k=k instanceof H?k===this.a?k.b:k.a:k;a.activeTexture(a.TEXTURE0+this.b);a.bindTexture(a.TEXTURE_2D,k);a.uniform1i(l,this.b++)}}}}
function A(a,b,e){const d=a.c,c=d.createTexture();d.bindTexture(d.TEXTURE_2D,c);a.f.b(b,e);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.bindTexture(d.TEXTURE_2D,null);return c}class H{constructor(a,b){this.g=a.createFramebuffer();this.c=a;this.f=b;this.a=this.b=null}};})()
//# sourceMappingURL=shader-web-background.min.js.map
