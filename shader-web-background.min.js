function g(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}}var n="function"==typeof Object.create?Object.create:function(a){function c(){}c.prototype=a;return new c},p;if("function"==typeof Object.setPrototypeOf)p=Object.setPrototypeOf;else{var t;a:{var u={f:!0},w={};try{w.__proto__=u;t=w.f;break a}catch(a){}t=!1}p=t?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null}var x=p;
function y(a){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.name="ShaderWebBackgroundException"}var z=Error;y.prototype=n(z.prototype);y.prototype.constructor=y;if(x)x(y,z);else for(var B in z)if("prototype"!=B)if(Object.defineProperties){var D=Object.getOwnPropertyDescriptor(z,B);D&&Object.defineProperty(y,B,D)}else y[B]=z[B];
function E(a,c,e){function f(){A=performance.now()/1E3;if(d.width!==d.clientWidth||d.height!==d.clientHeight){d.width=d.clientWidth;d.height=d.clientHeight;b.viewport(0,0,b.canvas.width,b.canvas.height);var h=l;var m="undefined"!=typeof Symbol&&Symbol.iterator&&h[Symbol.iterator];h=m?m.call(h):{next:g(h)};for(m=h.next();!m.done;m=h.next())m.value.release();l=F(b,d.width,d.height,v);r()}b.useProgram(k);b.uniform1f(J,A);b.uniform1i(K,C);b.bindFramebuffer(b.FRAMEBUFFER,l[0].c);b.bindTexture(b.TEXTURE_2D,
l[1].b);b.drawArrays(b.TRIANGLE_STRIP,0,4);b.useProgram(q);b.bindFramebuffer(b.FRAMEBUFFER,null);b.bindTexture(b.TEXTURE_2D,l[0].b);b.drawArrays(b.TRIANGLE_STRIP,0,4);l.reverse();C++;requestAnimationFrame(f)}function r(){var h=Math.min(d.width,d.height);b.useProgram(k);b.uniform2f(L,d.width,d.height);b.uniform1f(M,h);b.useProgram(q);b.uniform2f(N,d.width,d.height);b.uniform1f(O,h)}var d=document.getElementById(a);d.width=d.clientWidth;d.height=d.clientHeight;var b=d.getContext("webgl");if(!b)throw new y("webgl context not supported on supplied canvas element: "+
d);var v=b.getExtension("OES_texture_half_float");if(!v)throw new y("OES_texture_half_float is required but not supported here");if(!b.getExtension("OES_texture_half_float_linear"))throw new y("OES_texture_half_float_linear is required but not supported here");var l=F(b,d.width,d.height,v),k=G(b,c),q=G(b,e);b.useProgram(k);a=b.getAttribLocation(k,"V");c=H(b);b.bindBuffer(b.ARRAY_BUFFER,c);b.vertexAttribPointer(a,2,b.FLOAT,!1,0,0);b.enableVertexAttribArray(a);b.viewport(0,0,b.canvas.width,b.canvas.height);
var L=b.getUniformLocation(k,"R"),M=b.getUniformLocation(k,"D"),J=b.getUniformLocation(k,"T"),K=b.getUniformLocation(k,"F");b.useProgram(q);var N=b.getUniformLocation(q,"R"),O=b.getUniformLocation(q,"D");r();var C=0,A=0;f()}
function I(a,c,e,f){this.a=a;this.b=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.b);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,e,0,a.RGBA,f.HALF_FLOAT_OES,null);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);this.c=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,this.c);a.framebufferTexture2D(a.FRAMEBUFFER,
a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.b,0)}I.prototype.release=function(){this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.c);this.a.deleteTexture(this.b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,null);this.a.deleteFramebuffer(this.c)};function P(a,c,e){c=a.createShader(c);a.shaderSource(c,e);a.compileShader(c);if(!a.getShaderParameter(c,a.COMPILE_STATUS)){var f=String(a.getShaderInfoLog(c));console.log(f,e);a.deleteShader(c);return f}return c}
function G(a,c){var e=P(a,a.VERTEX_SHADER,"\nattribute vec2 V;\n//attribute vec2 aUV;\n//varying vec2 vUV;\n\nvoid main() {\n    gl_Position = vec4(V, 0.0, 1.0);\n    //vUV = aUV;\n}\n");c=P(a,a.FRAGMENT_SHADER,c);var f=a.createProgram();a.attachShader(f,e);a.attachShader(f,c);a.linkProgram(f);return f}function H(a){var c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,-1,1,-1]),a.STATIC_DRAW);return c}
function F(a,c,e,f){var r=new I(a,c,e,f);a=new I(a,c,e,f);return[r,a]}
window.shaderCanvas=function(a,c,e){return new E(a,c&&document.getElementById(c)&&document.getElementById(c).text.trim()||"\nprecision mediump float;\n\nuniform vec2 R;\nuniform sampler2D T;\nvarying vec2 vUV;\n\nvoid main() {\n    // vUV is equal to gl_FragCoord/uScreenResolution\n    // do some pixel shader related work\n    gl_FragColor = vec4(0.);\n}\n",e&&document.getElementById(e)&&document.getElementById(e).text.trim()||"\nprecision mediump float;\n\nuniform vec2 R;\nuniform sampler2D T;\nvarying vec2 vUV;\n\nvoid main() {\n    // vUV is equal to gl_FragCoord/uScreenResolution\n    // do some pixel shader related work\n    gl_FragColor = texture2D(T, gl_FragCoord.xy/R);\n}\n")};
window.ShaderWebBackgroundException=y;
